# What is ELB

Pour Elastic Load Balancer

# Notes

* Expose DNS
* Provide SSL termination
* Enforce stickiness with cookies
* High availability across zones
* Separate public traffic from private traffic
* Can perform health checks (for ex to EC2)
* Types
    * Classic load balancer : http, tcp, ssl (deprecated)
    * Application load balancer : http, websocket
    * Network load balancer : tcp, tls, udp
    * Gateway load balancer : layer 3 couche OSI
* Can be set as private (internal) or public (external)
* Link security group of ec2 to elb for more security (only traffic from elb to ec2 authorized)
* ALB
    * Load http to target groups (machines)
    * Support http2
    * Load balancing multiple application
    * Support redirects
    * Route based on path in URL
    * Route based on hostname
    * Route based on query string and headers
    * Port mapping feature
    * Target groups are targets for routing traffic : EC2 instances, ECS tasks, lambda, ip address (private ip)
    * Get fixed hostname with ALB
    * Application servers don't see IP of client, ip of clients are in header X-Forwarded-For and X-Forwarded-Proto (protocol)
    * Ne pas oublier de régler les security groups des instances pour que le traffic ne vienne que du load balancer
    * Pour les règles sur path query, il faut update les rules de l'ALB
* NLB
    * One static IP per AZ and supports Elastic IP
    * More performance
    * NLB can redirect to ALB
    * Health checks can be on TCP and HTTP
* GWLB : Gateway Load balancer
    * For example : Used to route traffic to virtual appliances and then route to application
    * Example : firewalls, intrusion detection, payload manipulation, etc
    * Use GENEVE protocol on port 6081
* Sticky sessions : add cookie to route to same instance. Has expiration date
    * Application based cookies : 
			§ custom cookie generated by application. Each target group has to use different cookie name (cannot be AWSALB, AWSALBAPP, AWSALBTG)
			§ Generated by the load balancer. Name is AWSALBAPP
    * Duration based cookie
			§ Generated by the load balancer. Name is AWSALB  or AWSELB for CLB
* Cross zone load balancing
    * With : Distribute to each instances
    * Without : Distribute to each node
* SSL certificates
    * ELB handle SSL
    * Can use ACM (AWS Certificate Manager)
    * Can use own certificates
    * HTTPS listener
			§ Must specify default certificat
			§ Can support mutiple domains
			§ Clients can use SNI (Server Name Indication) to specify hostname to reach
* SNI : Server name indication
    * Solves problem of loading multiple SSL certificates on one web server
    * Only work for ALB and NLB, cloudfront
* Certificate SSL
    * Add listener to 443
    * Add secure listener settings and set where is the certificate
* Connection draining
    * Named deregistration delay for ALB and NLB
    * Connection draining for CLB
    * Concept of stop sending requests to an instance which is deregistering after completing last one
